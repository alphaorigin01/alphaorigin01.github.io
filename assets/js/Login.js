// Generated by CoffeeScript 1.9.2
(function() {
  'use strict';
  var app;

  app = angular.module('Login', ['AthleteService']);


  /*                      Controllers */

  app.controller('LoginController', [
    '$scope', '$rootScope', 'Athlete', function($scope, $rootScope, Athlete) {
      $scope.$on('Server : Online', function() {
        return $scope.$evalAsync(function() {
          if (Athlete._rev == null) {
            return $scope.visibleLogin = true;
          }
        });
      });
      $scope.login = function() {
        if (($scope.username == null) || $scope.username === '' || ($scope.password == null) || $scope.password === '') {
          return;
        }
        return $rootScope.$broadcast('AthleteService : Login', {
          username: $scope.username,
          password: $scope.password
        });
      };
      $('.password').bind('keydown', function(e) {
        if (e.keyCode === 13) {
          e.preventDefault();
          return $scope.login();
        }
      });
      return $scope.$on('Context Switch', function() {
        return $scope.visibleLogin = false;
      });
    }
  ]);


  /*                      Directives */

  app.directive('login', function() {
    return {
      restrict: 'E',
      templateUrl: 'assets/templates/Login.html',
      controller: 'LoginController',
      scope: true,
      replace: true
    };
  });

}).call(this);
