(function(){"use strict";var e;e=angular.module("Messages",["AthleteService","PubNubService"]),e.controller("MessagesController",["$scope","$rootScope","$timeout","Athlete","PubNub",function(e,s,t,n,r){return e.athlete=n,e.$on("Context Switch",function(s,n){return e.visibleMessages=_.contains(["Athlete Profile"],n),e.visibleMessages?t(function(){return $("#messages .history").animate({scrollTop:$("#messages .history").get(0).scrollHeight},1e3)}):void 0}),window.Messages=e.history=[],e.$on("PubNubService : Athlete Connected",function(){return r("Messages : Get History",null)}),e.$on("Messages : Update History",function(s,t){return window.Messages=e.history=t[0]}),e.$on("Messages : Incoming Message",function(s,t){return e.$evalAsync(function(){return e.history.push(t),$("#messages .history").animate({scrollTop:$("#messages .history").get(0).scrollHeight},2e3)})}),e.send_message=function(){return r("Messages : Send Message",{sender:n._id,text:e.message_text}),e.message_text=""}}]),e.directive("messages",function(){return{restrict:"E",templateUrl:"assets/templates/Messages.html",controller:"MessagesController",scope:!0,replace:!0}})}).call(this);