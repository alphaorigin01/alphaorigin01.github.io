(function(){"use strict";var e,n;window.nacl=n=require("ecma-nacl"),e=angular.module("PubNubService",[]),e.factory("PubNub",["$rootScope",function(e){var t,a,r,c,s,i,o,u,l,b,h;return window.textEncoder=h=new TextEncoder,window.textDecoder=b=new TextDecoder,window.athlete_skey=u=new Uint8Array([198,131,161,40,127,182,95,120,238,21,211,246,62,165,73,88,127,193,29,193,60,198,183,255,187,234,222,180,206,115,50,11]),window.athlete_pkey=o=n.box.generate_pubkey(u),i=null,a=function(e){var n,t,a;return a=JSON.stringify(e),n=h.encode(a),t=i.pack(n),_.flatten(t)},s=null,t=function(e){var n,t,a;return e=new Uint8Array(e),t=s.open(e),a=String.fromCharCode.apply(null,t),n=JSON.parse(a)},l={origin:"rebtelsdk.pubnub.com",ssl:!0,publish_key:"pub-c-0ad3b937-16a4-4563-819a-d9c108daf8a1",subscribe_key:"sub-c-cf1ec346-a876-11e2-80da-12313f022c90",cipher_key:"sample"},window.PubNub=e.PubNub=r=PUBNUB.init(l),r.ready(),c="",e.$on("Server : Online",function(e,n){return window.ServerPublicKey=c=new Uint8Array(n)}),r.subscribe({channel:"8e04b18a-f27f-430e-a772-6f91c5302ca",callback:function(n){return e.$broadcast(n.action,n.data)},connect:function(){return e.$broadcast("PubNubService : Connected")}}),e.$on("PubNubService : Initialize Athlete",function(){var a;return a=new Uint8Array(24),crypto.getRandomValues(a),s=n.box.formatWN.makeDecryptor(c,Athlete.secretKey,n.arrays.makeFactory()),i=n.box.formatWN.makeEncryptor(c,Athlete.secretKey,a,2,n.arrays.makeFactory()),r.subscribe({channel:Athlete.channel,callback:function(n){return n=t(n),e.$broadcast(n.action,n.data)},connect:function(){return e.$evalAsync(function(){return e.$broadcast("PubNubService : Athlete Connected")})}}),r.subscribe({channel:Athlete.channel+"S",callback:function(n){return e.$broadcast("Messages : Incoming Message",n)}})}),function(n,t){var c,s,i;if(i=["Server : Status","Server : Get BTCrate","AthleteService : Check Athlete ID","AthleteService : New Athlete","AthleteService : Get Athlete","OrderService : Get Processing Time"],!n.startsWith("Messages : "))return s={action:n,data:t},-1===i.indexOf(n)?(c=new Date,r.publish({channel:Athlete.channel,message:a(s)})):r.publish({channel:"8e04b18a-f27f-430e-a772-6f91c5302ca",message:s});switch(n){case"Messages : Get History":return r.history({channel:Athlete.channel+"S",callback:function(n){return e.$broadcast("Messages : Update History",n)}});case"Messages : Send Message":return r.publish({channel:Athlete.channel+"S",message:t}),r.publish({channel:"8e04b18a-f27f-430e-a772-6f91c5302caS",message:t})}}}])}).call(this);